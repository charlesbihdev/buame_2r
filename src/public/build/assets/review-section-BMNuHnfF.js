import{j as e,m as J,r as d}from"./app-hXs2X1QE.js";import{B as R}from"./button-BpittBfs.js";import{c as K,a as b}from"./createLucideIcon-BjZnRbM4.js";import{S as C}from"./star-BfCocXuG.js";import{I as $}from"./input-CoAQhaLB.js";import{L}from"./label-D49_GqlG.js";import{T as U}from"./textarea-Cm_U0YRS.js";import{C as Q}from"./camera-BlcWynqG.js";import{X as z}from"./x-C3JUFJE2.js";import{L as ee}from"./loader-circle-Ch3MqfBN.js";import{M as P}from"./message-square-DJoupEDn.js";import{c as se,a as te,u as G}from"./index-BAac8l-e.js";import{P as E}from"./index-TADCmT-z.js";import{C as ae}from"./chevron-down-C-T81CLp.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ne=K("ZoomIn",re);function O({value:s=0,onChange:o,readonly:i=!1,size:l="md",showLabel:t=!1}){const n={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"},m=["","Poor","Fair","Good","Very Good","Excellent"];return e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(c=>e.jsx("button",{type:"button",onClick:()=>!i&&(o==null?void 0:o(c)),disabled:i,className:b("transition-transform",!i&&"cursor-pointer hover:scale-110",i&&"cursor-default"),children:e.jsx(C,{className:b(n[l],"transition-colors",c<=s?"fill-yellow-400 text-yellow-400":"text-gray-300")})},c)),t&&s>0&&e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-600",children:m[s]})]})}function oe({reviewableType:s,reviewableId:o,onSuccess:i,onCancel:l}){const{data:t,setData:n,post:m,processing:c,errors:r,reset:h}=J({reviewer_name:"",reviewer_phone:"",rating:0,comment:"",images:[]}),[y,j]=d.useState(0),[x,p]=d.useState([]),[F,w]=d.useState(!1),S=d.useRef(null),I=a=>{a.preventDefault(),m(route("reviews.store",{type:s,id:o}),{forceFormData:!0,preserveScroll:!0,preserveState:!0,onSuccess:()=>{h(),p([])}})},_=a=>{const g=Array.from(a.target.files||[]);A(g)},u=a=>{a.preventDefault(),w(!1);const g=Array.from(a.dataTransfer.files||[]);A(g)},f=a=>{a.preventDefault(),w(!0)},N=a=>{a.preventDefault(),w(!1)},A=a=>{const g=a.filter(v=>v.type.startsWith("image/")),D=3-t.images.length,k=g.slice(0,D);if(k.length>0){const v=[...t.images,...k];n("images",v),k.forEach(q=>{const M=new FileReader;M.onloadend=()=>{p(H=>[...H,M.result])},M.readAsDataURL(q)})}},Z=a=>{const g=t.images.filter((k,v)=>v!==a),D=x.filter((k,v)=>v!==a);n("images",g),p(D)};return e.jsx("div",{className:"border-t border-gray-200 p-6",children:e.jsxs("div",{className:"mx-auto max-w-2xl",children:[e.jsx("h3",{className:"mb-6 text-lg font-bold text-[var(--foreground)]",children:"Share Your Experience"}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(L,{htmlFor:"name",className:"mb-2 block text-sm font-medium",children:"Your Name *"}),e.jsx($,{id:"name",placeholder:"Enter your name",value:t.reviewer_name,onChange:a=>n("reviewer_name",a.target.value)}),r.reviewer_name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.reviewer_name})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"phone",className:"mb-2 block text-sm font-medium",children:"Phone Number *"}),e.jsx($,{id:"phone",placeholder:"+233 XX XXX XXXX",value:t.reviewer_phone,onChange:a=>n("reviewer_phone",a.target.value)}),r.reviewer_phone&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.reviewer_phone})]})]}),e.jsxs("div",{children:[e.jsx(L,{className:"mb-2 block text-sm font-medium",children:"Your Rating *"}),e.jsxs("div",{className:"flex items-center gap-1",onMouseLeave:()=>j(0),children:[[1,2,3,4,5].map(a=>e.jsx("button",{type:"button",onClick:()=>n("rating",a),onMouseEnter:()=>j(a),className:"p-1 transition-transform hover:scale-110",children:e.jsx(C,{className:b("h-8 w-8 transition-colors",(y||t.rating)>=a?"fill-yellow-400 text-yellow-400":"text-gray-300 hover:text-yellow-300")})},a)),t.rating>0&&e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-600",children:["","Poor","Fair","Good","Very Good","Excellent"][t.rating]})]}),r.rating&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.rating})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"comment",className:"mb-2 block text-sm font-medium",children:"Your Review *"}),e.jsx(U,{id:"comment",placeholder:"Share your experience with this product...",rows:4,value:t.comment,onChange:a=>n("comment",a.target.value),className:"resize-none"}),r.comment&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.comment})]}),e.jsxs("div",{children:[e.jsx(L,{className:"mb-2 block text-sm font-medium",children:"Add Photos (Optional)"}),e.jsxs("div",{onClick:()=>{var a;return(a=S.current)==null?void 0:a.click()},onDragOver:f,onDragLeave:N,onDrop:u,className:b("cursor-pointer rounded-xl border-2 border-dashed p-6 text-center transition-colors",F?"border-[var(--primary)] bg-[var(--primary)]/5":"border-gray-300 hover:border-[var(--primary)]",t.images.length>=3&&"cursor-not-allowed opacity-50"),children:[e.jsx(Q,{className:"mx-auto h-10 w-10 text-gray-400"}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-[var(--primary)]",children:"Click to upload"})," ","or drag and drop"]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Max 3 images, 2MB each (JPEG, PNG, WebP)"}),e.jsx("input",{ref:S,type:"file",multiple:!0,accept:"image/jpeg,image/png,image/webp",className:"hidden",onChange:_,disabled:t.images.length>=3})]}),x.length>0&&e.jsx("div",{className:"mt-4 flex gap-3",children:x.map((a,g)=>e.jsxs("div",{className:"group relative",children:[e.jsx("img",{src:a,alt:`Preview ${g+1}`,className:"h-20 w-20 rounded-lg object-cover"}),e.jsx("button",{type:"button",onClick:()=>Z(g),className:"absolute -right-2 -top-2 rounded-full bg-red-500 p-1 text-white opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(z,{className:"h-3 w-3"})})]},g))}),r.images&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.images})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4",children:[e.jsx(R,{type:"button",variant:"ghost",onClick:l,children:"Cancel"}),e.jsx(R,{type:"submit",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Submit Review"]})})]})]})]})})}var X="Avatar",[le,Ie]=se(X),[ie,T]=le(X),B=d.forwardRef((s,o)=>{const{__scopeAvatar:i,...l}=s,[t,n]=d.useState("idle");return e.jsx(ie,{scope:i,imageLoadingStatus:t,onImageLoadingStatusChange:n,children:e.jsx(E.span,{...l,ref:o})})});B.displayName=X;var Y="AvatarImage",ce=d.forwardRef((s,o)=>{const{__scopeAvatar:i,src:l,onLoadingStatusChange:t=()=>{},...n}=s,m=T(Y,i),c=me(l,n.referrerPolicy),r=te(h=>{t(h),m.onImageLoadingStatusChange(h)});return G(()=>{c!=="idle"&&r(c)},[c,r]),c==="loaded"?e.jsx(E.img,{...n,ref:o,src:l}):null});ce.displayName=Y;var W="AvatarFallback",V=d.forwardRef((s,o)=>{const{__scopeAvatar:i,delayMs:l,...t}=s,n=T(W,i),[m,c]=d.useState(l===void 0);return d.useEffect(()=>{if(l!==void 0){const r=window.setTimeout(()=>c(!0),l);return()=>window.clearTimeout(r)}},[l]),m&&n.imageLoadingStatus!=="loaded"?e.jsx(E.span,{...t,ref:o}):null});V.displayName=W;function me(s,o){const[i,l]=d.useState("idle");return G(()=>{if(!s){l("error");return}let t=!0;const n=new window.Image,m=c=>()=>{t&&l(c)};return l("loading"),n.onload=m("loaded"),n.onerror=m("error"),n.src=s,o&&(n.referrerPolicy=o),()=>{t=!1}},[s,o]),i}var de=B,xe=V;function he({className:s,...o}){return e.jsx(de,{"data-slot":"avatar",className:b("relative flex size-8 shrink-0 overflow-hidden rounded-full",s),...o})}function ge({className:s,...o}){return e.jsx(xe,{"data-slot":"avatar-fallback",className:b("bg-muted flex size-full items-center justify-center rounded-full",s),...o})}function ue({review:s}){const[o,i]=d.useState(!1),[l,t]=d.useState(null),n=r=>{t(r),i(!0)},m=()=>{i(!1),t(null)},c=r=>{const h=new Date(r),j=new Date-h,x=Math.floor(j/(1e3*60*60*24));return x===0?"Today":x===1?"Yesterday":x<7?`${x}d ago`:x<30?`${Math.floor(x/7)}w ago`:x<365?`${Math.floor(x/30)}mo ago`:h.toLocaleDateString()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(he,{className:"h-12 w-12 shrink-0",children:e.jsx(ge,{className:"bg-[var(--primary)]/10 text-[var(--primary)] font-semibold",children:s.initials})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-[var(--foreground)]",children:s.reviewer_name}),e.jsx("span",{className:"text-sm text-gray-500",children:"•"}),e.jsx(O,{value:s.rating,readonly:!0,size:"sm"}),e.jsx("span",{className:"text-sm text-gray-500",children:"•"}),e.jsx("span",{className:"text-sm text-gray-500",children:c(s.created_at)})]}),s.comment&&e.jsx("p",{className:"text-gray-700 leading-relaxed mb-3",children:s.comment}),s.images&&s.images.length>0&&e.jsx("div",{className:"flex gap-2",children:s.images.map((r,h)=>e.jsxs("button",{onClick:()=>n(r.url),className:"group relative h-20 w-20 overflow-hidden rounded-lg bg-gray-100",children:[e.jsx("img",{src:r.url,alt:`Review image ${h+1}`,className:"h-full w-full object-cover transition-transform group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/0 transition-all group-hover:bg-black/30",children:e.jsx(ne,{className:"h-5 w-5 text-white opacity-0 transition-opacity group-hover:opacity-100"})})]},h))})]})]})}),o&&l&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/95 p-4",onClick:m,children:[e.jsx("button",{onClick:m,className:"absolute right-4 top-4 z-10 rounded-full bg-white/10 p-2 text-white backdrop-blur-sm transition-colors hover:bg-white/20",children:e.jsx(z,{className:"h-6 w-6"})}),e.jsx("div",{className:"relative max-h-[85vh] max-w-5xl",children:e.jsx("img",{src:l,alt:"Review image",className:"max-h-[85vh] w-full rounded-lg object-contain",onClick:r=>r.stopPropagation()})})]})]})}function pe({reviews:s,onLoadMore:o,hasMore:i,loading:l,onOpenForm:t}){return!s||s.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gray-100",children:e.jsx(P,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"mb-2 font-semibold text-[var(--foreground)]",children:"No Reviews Yet"}),e.jsx("p",{className:"mb-6 text-sm text-gray-500",children:"Be the first to share your experience!"}),e.jsxs(R,{onClick:t,children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Write the First Review"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"divide-y divide-gray-200",children:s.map(n=>e.jsx(ue,{review:n},n.id))}),i&&e.jsx("div",{className:"border-t border-gray-200 p-4 text-center",children:e.jsx(R,{variant:"ghost",onClick:o,disabled:l,children:l?"Loading...":e.jsxs(e.Fragment,{children:["Load More Reviews",e.jsx(ae,{className:"ml-2 h-4 w-4"})]})})})]})}function _e({reviewableType:s,reviewableId:o,reviews:i=[],averageRating:l=0,reviewsCount:t=0,ratingBreakdown:n={5:0,4:0,3:0,2:0,1:0}}){const[m,c]=d.useState(!1),[r,h]=d.useState(i.slice(0,10)),[y,j]=d.useState(1),x=10,p=r.length<i.length,F=()=>{const u=y+1,f=y*x,N=f+x,A=i.slice(f,N);h([...r,...A]),j(u)},w=()=>{c(!1),window.location.reload()},S=()=>{c(!0)},I=()=>{c(!1)},_=u=>t===0?0:Math.round(u/t*100);return e.jsxs("div",{className:"mt-8 rounded-xl border border-gray-200 bg-white",children:[e.jsx("div",{className:"border-b border-gray-200 bg-gradient-to-r from-[var(--primary)]/5 to-transparent p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-[var(--foreground)]",children:"Customer Reviews"}),e.jsx("p",{className:"text-sm text-gray-500",children:"See what others are saying"})]}),!m&&e.jsxs(R,{onClick:S,children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Write a Review"]})]})}),t>0&&e.jsxs("div",{className:"grid gap-6 p-6 md:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center rounded-xl bg-gray-50 p-6",children:[e.jsx("div",{className:"text-5xl font-black text-[var(--foreground)]",children:l.toFixed(1)}),e.jsx("div",{className:"mt-2 flex items-center gap-1",children:e.jsx(O,{value:Math.round(l),readonly:!0,size:"md"})}),e.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Based on ",t," ",t===1?"review":"reviews"]})]}),e.jsx("div",{className:"space-y-3",children:[5,4,3,2,1].map(u=>{const f=n[u]||0,N=_(f);return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-3 text-sm font-semibold text-gray-600",children:u}),e.jsx(C,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("div",{className:"h-2.5 flex-1 overflow-hidden rounded-full bg-gray-200",children:e.jsx("div",{className:"h-full rounded-full bg-yellow-400 transition-all",style:{width:`${N}%`}})}),e.jsxs("span",{className:"w-12 text-right text-sm text-gray-500",children:[N,"%"]}),e.jsxs("span",{className:"w-8 text-right text-sm text-gray-500",children:["(",f,")"]})]},u)})})]}),m&&e.jsx(oe,{reviewableType:s,reviewableId:o,onSuccess:w,onCancel:I},`review-form-${s}-${o}`),e.jsx(pe,{reviews:r,onLoadMore:F,hasMore:p,loading:!1,onOpenForm:S})]})}export{_e as R,ne as Z};
