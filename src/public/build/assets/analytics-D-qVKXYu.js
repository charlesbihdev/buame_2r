import{j as e,L,$ as B,S as $}from"./app-CxoXxl0n.js";import{S as a}from"./StatsCard-rOv_3aDK.js";import{B as O}from"./button-w2roNN0a.js";import{C as n,a as d,b as o,c,d as m}from"./card-B9TwuhEb.js";import{S as k,a as T,b as D,c as E,d as x}from"./select-BkAg5goD.js";import{A as M}from"./admin-layout-C2BVzl7f.js";import{A as z}from"./arrow-left-DwVBw9Uh.js";import{C as R}from"./calendar-enDgVmRx.js";import{C as V}from"./circle-check-big-DEbecjCb.js";import{T as G}from"./trending-up-W9FwaFdI.js";import{T as H,C as I}from"./toast-provider-CH31fDaW.js";import{C as P}from"./clock-DtpQOpne.js";import"./utils-jAU0Cazi.js";import"./index-BAH8w1fj.js";import"./index-BCMrN5LL.js";import"./Combination-ByAuZyvo.js";import"./index-DOjZFm5B.js";import"./index-Dv0f-u-0.js";import"./index-DGlnt-Sl.js";import"./chevron-down-C2ACAUIm.js";import"./createLucideIcon-Cq5sRYT8.js";import"./check-yWFfF0D4.js";import"./app-logo-BM-LlunS.js";import"./users-c1etufqx.js";import"./package-DnCdIKln.js";import"./credit-card-D0SomOQR.js";import"./shield-DL4ciyu8.js";import"./log-out-B5HHbhXm.js";import"./x-DH78n1D0.js";import"./menu-DuikxJ3x.js";function fe({analytics:t,dateRange:p}){var h,u,j,g,b,f,v;const N=s=>{$.get(route("admin.subscriptions.analytics"),{range:s},{preserveState:!0})},C={artisans:"bg-blue-500",hotels:"bg-purple-500",transport:"bg-green-500",rentals:"bg-yellow-500",marketplace:"bg-pink-500",jobs:"bg-orange-500"},S={Active:"bg-green-500","Grace Period":"bg-yellow-500",Expired:"bg-red-500",Cancelled:"bg-gray-500"},i=Object.values(t.byCategory||{}).reduce((s,r)=>s+r,0),l=Object.values(t.byStatus||{}).reduce((s,r)=>s+r,0);return e.jsxs(M,{children:[e.jsx(L,{title:"Subscription Analytics"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(B,{href:route("admin.subscriptions.index"),children:e.jsxs(O,{variant:"ghost",size:"sm",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Back"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-foreground text-2xl font-bold",children:"Subscription Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"Overview of subscription metrics"})]})]}),e.jsxs(k,{value:String(p),onValueChange:N,children:[e.jsxs(T,{className:"w-[180px]",children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),e.jsx(D,{})]}),e.jsxs(E,{children:[e.jsx(x,{value:"7",children:"Last 7 days"}),e.jsx(x,{value:"30",children:"Last 30 days"}),e.jsx(x,{value:"90",children:"Last 90 days"}),e.jsx(x,{value:"365",children:"Last year"})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(a,{title:"Total Active",value:((h=t.totalActive)==null?void 0:h.toLocaleString())||0,description:"Active subscriptions",icon:V}),e.jsx(a,{title:"New Subscriptions",value:((u=t.newSubscriptions)==null?void 0:u.toLocaleString())||0,description:`Last ${p} days`,icon:G}),e.jsx(a,{title:"Expiring Soon",value:((j=t.expiringSoon)==null?void 0:j.toLocaleString())||0,description:"Within 7 days",icon:H}),e.jsx(a,{title:"Recently Expired",value:((g=t.recentlyExpired)==null?void 0:g.toLocaleString())||0,description:"Last 30 days",icon:I})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Active by Category"}),e.jsx(c,{children:"Distribution of active subscriptions"})]}),e.jsx(m,{children:Object.keys(t.byCategory||{}).length>0?e.jsx("div",{className:"space-y-4",children:Object.entries(t.byCategory).map(([s,r])=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-foreground text-sm font-medium capitalize",children:s}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:[r," (",i>0?Math.round(r/i*100):0,"%)"]})]}),e.jsx("div",{className:"bg-muted h-2 overflow-hidden rounded-full",children:e.jsx("div",{className:`h-full rounded-full ${C[s]||"bg-primary"}`,style:{width:`${i>0?r/i*100:0}%`}})})]},s))}):e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:"No data available"})})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"By Status"}),e.jsx(c,{children:"All subscriptions by status"})]}),e.jsx(m,{children:Object.keys(t.byStatus||{}).length>0?e.jsx("div",{className:"space-y-4",children:Object.entries(t.byStatus).map(([s,r])=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-foreground text-sm font-medium",children:s}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:[r," (",l>0?Math.round(r/l*100):0,"%)"]})]}),e.jsx("div",{className:"bg-muted h-2 overflow-hidden rounded-full",children:e.jsx("div",{className:`h-full rounded-full ${S[s]||"bg-primary"}`,style:{width:`${l>0?r/l*100:0}%`}})})]},s))}):e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:"No data available"})})]})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Billing Cycle Distribution"}),e.jsx(c,{children:"Active subscriptions by billing cycle"})]}),e.jsx(m,{children:Object.keys(t.byBillingCycle||{}).length>0?e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:Object.entries(t.byBillingCycle).map(([s,r])=>e.jsxs("div",{className:"border-border rounded-lg border p-4 text-center",children:[e.jsx("div",{className:"bg-primary/10 text-primary mx-auto mb-2 flex h-12 w-12 items-center justify-center rounded-full",children:e.jsx(P,{className:"h-6 w-6"})}),e.jsx("p",{className:"text-foreground text-2xl font-bold",children:r}),e.jsx("p",{className:"text-muted-foreground text-sm",children:s})]},s))}):e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:"No data available"})})]}),((b=t.trend)==null?void 0:b.length)>0&&e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"New Subscriptions Trend"}),e.jsx(c,{children:"Daily new subscriptions over the selected period"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"flex h-[200px] items-end gap-1",children:t.trend.map((s,r)=>{const y=Math.max(...t.trend.map(A=>A.count)),w=y>0?s.count/y*100:0;return e.jsx("div",{className:"group relative flex-1",title:`${s.date}: ${s.count} subscriptions`,children:e.jsx("div",{className:"bg-primary/20 hover:bg-primary/40 absolute bottom-0 w-full rounded-t transition-colors",style:{height:`${Math.max(w,4)}%`}})},r)})}),e.jsxs("div",{className:"text-muted-foreground mt-2 flex justify-between text-xs",children:[e.jsx("span",{children:(f=t.trend[0])==null?void 0:f.date}),e.jsx("span",{children:(v=t.trend[t.trend.length-1])==null?void 0:v.date})]})]})]})]})]})}export{fe as default};
