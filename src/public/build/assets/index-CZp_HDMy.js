import{j as e,r as b,$,L as O,S as k}from"./app-Bs8coIO6.js";import{B as u}from"./button-DudFTLrK.js";import{C as z}from"./check-BVBBhXrQ.js";import{X as L}from"./x-DxW1BhX3.js";import{T as M}from"./trash-2-BRzvUhYe.js";import{C as E}from"./ConfirmDialog-n0zYRcmV.js";import{F as J}from"./FilterBar-BGnEvz1r.js";import{D as U,a as q,b as G,c as X}from"./dialog-D_nWVE28.js";import{C as S}from"./chevron-left-9ZnauC5v.js";import{C}from"./chevron-right-BTWnZOES.js";import{C as R}from"./checkbox-CwSIXX93.js";import{S as K}from"./StatusBadge-CMb1JO7t.js";import{T as Q,a as W,b as N}from"./tabs-DoE8WFLP.js";import{A as Y}from"./admin-layout-47xZIB6y.js";import{M as Z}from"./message-square-BCCcfqau.js";import{S as ee}from"./star-1DdTyEsK.js";import{I as te}from"./image-CQjCR9ub.js";import"./createLucideIcon-CfAvFVWA.js";import"./input-CL6PQ8Xp.js";import"./select-mHEP3dnH.js";import"./index-D-VOFXDz.js";import"./index-DR_rHw7u.js";import"./index-DA82A8HG.js";import"./Combination-Cb1f753D.js";import"./index-BcrR9kC8.js";import"./index-DpJVnh_N.js";import"./index-DlPQFw3s.js";import"./chevron-down-BB6U136u.js";import"./chevron-up-5M2geU9w.js";import"./search-AyMPv5S-.js";import"./index-BZXK1UHL.js";import"./index-BNnI7ZhX.js";import"./app-logo-DO43qxbN.js";import"./toast-provider-BkeFFm4y.js";import"./users-CuPztf1Q.js";import"./package-BKldpW_W.js";import"./credit-card-BUR1STf3.js";import"./shield-gENbGVN6.js";import"./log-out-BIBeuX1h.js";import"./menu-ChqbcmUP.js";function se({selectedCount:c,onApprove:i,onDisapprove:s,onDelete:x,onClear:m,showDelete:n=!1,processing:d=!1}){return c===0?null:e.jsxs("div",{className:"bg-primary/5 border-primary/20 flex items-center justify-between rounded-lg border px-4 py-3",children:[e.jsxs("span",{className:"text-foreground text-sm font-medium",children:[c," review",c>1?"s":""," selected"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsxs(u,{variant:"outline",size:"sm",onClick:i,disabled:d,className:"gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),"Approve"]}),s&&e.jsxs(u,{variant:"outline",size:"sm",onClick:s,disabled:d,className:"gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Disapprove"]}),n&&x&&e.jsxs(u,{variant:"destructive",size:"sm",onClick:x,disabled:d,className:"gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),"Delete"]}),e.jsx(u,{variant:"ghost",size:"sm",onClick:m,disabled:d,children:"Clear Selection"})]})]})}function ae({open:c,onOpenChange:i,images:s=[],title:x="Review Images"}){var v;const[m,n]=b.useState(0);b.useEffect(()=>{c&&n(0)},[c,s]);const d=()=>{n(p=>p===0?s.length-1:p-1)},o=()=>{n(p=>p===s.length-1?0:p+1)};return s.length?e.jsx(U,{open:c,onOpenChange:i,children:e.jsxs(q,{className:"max-w-3xl",children:[e.jsx(G,{children:e.jsx(X,{children:x})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"relative aspect-video overflow-hidden rounded-lg bg-black",children:e.jsx("img",{src:`/storage/${(v=s[m])==null?void 0:v.image_path}`,alt:`Image ${m+1}`,className:"h-full w-full object-contain"})}),s.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(u,{variant:"secondary",size:"icon",className:"absolute left-2 top-1/2 -translate-y-1/2",onClick:d,children:e.jsx(S,{className:"h-4 w-4"})}),e.jsx(u,{variant:"secondary",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2",onClick:o,children:e.jsx(C,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 rounded-full bg-black/50 px-3 py-1 text-sm text-white",children:[m+1," / ",s.length]})]}),s.length>1&&e.jsx("div",{className:"mt-4 flex gap-2 overflow-x-auto pb-2",children:s.map((p,f)=>e.jsx("button",{onClick:()=>n(f),className:`h-16 w-16 shrink-0 overflow-hidden rounded-md border-2 transition-colors ${f===m?"border-primary":"border-transparent"}`,children:e.jsx("img",{src:`/storage/${p.image_path}`,alt:`Thumbnail ${f+1}`,className:"h-full w-full object-cover"})},p.id||f))})]})}):null}function re({columns:c,data:i,pagination:s,emptyMessage:x="No data found",emptyIcon:m,selectedIds:n,onSelectionChange:d}){const o=i.length>0&&i.every(a=>n.includes(a.id)),v=i.some(a=>n.includes(a.id)),p=a=>{if(a){const g=[...new Set([...n,...i.map(l=>l.id)])];d(g)}else{const g=i.map(l=>l.id);d(n.filter(l=>!g.includes(l)))}},f=(a,g)=>{d(g?[...n,a]:n.filter(l=>l!==a))};return e.jsxs("div",{className:"border-border rounded-lg border",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 px-4 py-3",children:e.jsx(R,{checked:o,"data-state":v&&!o?"indeterminate":void 0,onCheckedChange:p})}),c.map(a=>e.jsx("th",{className:"text-muted-foreground px-4 py-3 text-left text-sm font-medium",children:a.label},a.key))]})}),e.jsx("tbody",{children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:c.length+1,className:"text-muted-foreground px-4 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[m&&e.jsx(m,{className:"h-10 w-10 opacity-50"}),e.jsx("p",{children:x})]})})}):i.map((a,g)=>e.jsxs("tr",{className:"border-border hover:bg-muted/30 border-t transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(R,{checked:n.includes(a.id),onCheckedChange:l=>f(a.id,l)})}),c.map(l=>e.jsx("td",{className:"px-4 py-3 text-sm",children:l.render?l.render(a):a[l.key]},l.key))]},a.id||g))})]})}),s&&s.last_page>1&&e.jsxs("div",{className:"border-border flex items-center justify-between border-t px-4 py-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:["Showing ",s.from," to ",s.to," of ",s.total]}),e.jsxs("div",{className:"flex gap-2",children:[s.prev_page_url?e.jsx($,{href:s.prev_page_url,preserveScroll:!0,preserveState:!0,children:e.jsxs(u,{variant:"outline",size:"sm",children:[e.jsx(S,{className:"h-4 w-4"}),"Previous"]})}):e.jsxs(u,{variant:"outline",size:"sm",disabled:!0,children:[e.jsx(S,{className:"h-4 w-4"}),"Previous"]}),s.next_page_url?e.jsx($,{href:s.next_page_url,preserveScroll:!0,preserveState:!0,children:e.jsxs(u,{variant:"outline",size:"sm",children:["Next",e.jsx(C,{className:"h-4 w-4"})]})}):e.jsxs(u,{variant:"outline",size:"sm",disabled:!0,children:["Next",e.jsx(C,{className:"h-4 w-4"})]})]})]})]})}function Ue({reviews:c,filters:i,counts:s}){const[x,m]=b.useState([]),[n,d]=b.useState(!1),[o,v]=b.useState({open:!1,action:null,review:null}),[p,f]=b.useState({open:!1,images:[]}),a=i.status||"all",g=t=>{k.get(route("admin.reviews.index"),{...i,status:t==="all"?void 0:t},{preserveState:!0,preserveScroll:!0}),m([])},l=(t,r)=>{v({open:!0,action:r,review:t})},w=t=>{v({open:!0,action:t,review:null})},B=()=>{d(!0);const t=!o.review;let r,h={};if(t){switch(o.action){case"approve":r="admin.reviews.bulk-approve";break;case"disapprove":r="admin.reviews.bulk-disapprove";break;case"delete":r="admin.reviews.bulk-delete";break}h={ids:x},k.post(route(r),h,{preserveScroll:!0,onFinish:()=>{d(!1),v({open:!1,action:null,review:null}),m([])}})}else{switch(o.action){case"approve":r="admin.reviews.approve";break;case"disapprove":r="admin.reviews.disapprove";break;case"delete":r="admin.reviews.destroy";break}const j=o.action==="delete"?"delete":"post";k[j](route(r,o.review.id),h,{preserveScroll:!0,onFinish:()=>{d(!1),v({open:!1,action:null,review:null})}})}},F=()=>{var h,j;const t=!o.review,r=t?x.length:1;switch(o.action){case"approve":return{title:`Approve ${r} Review${r>1?"s":""}`,description:t?`Are you sure you want to approve ${r} selected reviews? They will be visible to users.`:`Are you sure you want to approve this review from "${(h=o.review)==null?void 0:h.reviewer_name}"?`,confirmLabel:"Approve",variant:"default"};case"disapprove":return{title:`Disapprove ${r} Review${r>1?"s":""}`,description:t?`Are you sure you want to disapprove ${r} selected reviews? They will be hidden from users.`:`Are you sure you want to disapprove this review from "${(j=o.review)==null?void 0:j.reviewer_name}"?`,confirmLabel:"Disapprove",variant:"destructive"};case"delete":return{title:`Delete ${r} Review${r>1?"s":""}`,description:t?`Are you sure you want to permanently delete ${r} selected reviews? This action cannot be undone.`:"Are you sure you want to permanently delete this review? This action cannot be undone.",confirmLabel:"Delete",variant:"destructive"};default:return{}}},I=t=>{var r,h,j,_,A,D,T;return((r=t.artisan)==null?void 0:r.name)||((h=t.hotel)==null?void 0:h.name)||((j=t.transport_ride)==null?void 0:j.vehicle_name)||((_=t.marketplace_product)==null?void 0:_.title)||((A=t.rental)==null?void 0:A.name)||((D=t.job)==null?void 0:D.title)||((T=t.store)==null?void 0:T.name)||"Unknown"},P=t=>t.artisan_id?"Artisan":t.hotel_id?"Hotel":t.transport_ride_id?"Transport":t.marketplace_product_id?"Product":t.rental_id?"Rental":t.job_id?"Job":t.store_id?"Store":"Unknown",V=[{key:"reviewer",label:"Reviewer",render:t=>e.jsxs("div",{children:[e.jsx("p",{className:"text-foreground font-medium",children:t.reviewer_name}),e.jsx("p",{className:"text-muted-foreground text-xs",children:t.reviewer_phone})]})},{key:"rating",label:"Rating",render:t=>e.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((r,h)=>e.jsx(ee,{className:`h-4 w-4 ${h<t.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},h))})},{key:"comment",label:"Comment",render:t=>e.jsx("p",{className:"text-foreground max-w-[300px] truncate text-sm",children:t.comment||e.jsx("span",{className:"text-muted-foreground italic",children:"No comment"})})},{key:"reviewable",label:"For",render:t=>e.jsxs("div",{children:[e.jsx("p",{className:"text-foreground text-sm",children:I(t)}),e.jsx("p",{className:"text-muted-foreground text-xs",children:P(t)})]})},{key:"images",label:"Images",render:t=>{var r;return((r=t.images)==null?void 0:r.length)>0?e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>f({open:!0,images:t.images}),className:"gap-1",children:[e.jsx(te,{className:"h-4 w-4"}),t.images.length]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"-"})}},{key:"status",label:"Status",render:t=>e.jsx(K,{status:t.status,type:"review"})},{key:"created_at",label:"Date",render:t=>e.jsx("span",{className:"text-muted-foreground text-sm",children:new Date(t.created_at).toLocaleDateString()})},{key:"actions",label:"Actions",render:t=>e.jsxs("div",{className:"flex items-center gap-1",children:[t.status!=="approved"&&e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>l(t,"approve"),children:e.jsx(z,{className:"h-4 w-4 text-green-500"})}),t.status!=="disapproved"&&e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>l(t,"disapprove"),children:e.jsx(L,{className:"h-4 w-4 text-orange-500"})}),t.status==="disapproved"&&e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>l(t,"delete"),children:e.jsx(M,{className:"text-destructive h-4 w-4"})})]})}],H=[{key:"rating",label:"Rating",placeholder:"Filter by rating",options:[{value:"5",label:"5 Stars"},{value:"4",label:"4 Stars"},{value:"3",label:"3 Stars"},{value:"2",label:"2 Stars"},{value:"1",label:"1 Star"}]},{key:"type",label:"Type",placeholder:"Filter by type",options:[{value:"artisan",label:"Artisan"},{value:"hotel",label:"Hotel"},{value:"transport",label:"Transport"},{value:"marketplace",label:"Marketplace"},{value:"rental",label:"Rental"},{value:"job",label:"Job"},{value:"store",label:"Store"}]}],y=F();return e.jsxs(Y,{children:[e.jsx(O,{title:"Review Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-foreground text-2xl font-bold",children:"Review Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Moderate and manage user reviews"})]}),e.jsx(Q,{value:a,onValueChange:g,children:e.jsxs(W,{children:[e.jsxs(N,{value:"all",activeValue:a,children:["All (",s.all,")"]}),e.jsxs(N,{value:"pending",activeValue:a,children:["Pending (",s.pending,")"]}),e.jsxs(N,{value:"approved",activeValue:a,children:["Approved (",s.approved,")"]}),e.jsxs(N,{value:"disapproved",activeValue:a,children:["Disapproved (",s.disapproved,")"]})]})}),e.jsx(J,{filters:H,searchPlaceholder:"Search by name, phone, or comment...",currentFilters:i}),e.jsx(se,{selectedCount:x.length,onApprove:a!=="approved"?()=>w("approve"):null,onDisapprove:a!=="disapproved"?()=>w("disapprove"):null,onDelete:a==="disapproved"?()=>w("delete"):null,showDelete:a==="disapproved",onClear:()=>m([]),processing:n}),e.jsx(re,{columns:V,data:c.data,pagination:c,emptyMessage:"No reviews found",emptyIcon:Z,selectedIds:x,onSelectionChange:m})]}),e.jsx(E,{open:o.open,onOpenChange:t=>v({...o,open:t}),title:y.title,description:y.description,confirmLabel:y.confirmLabel,variant:y.variant,onConfirm:B,loading:n}),e.jsx(ae,{open:p.open,onOpenChange:t=>f({...p,open:t}),images:p.images,title:"Review Images"})]})}export{Ue as default};
