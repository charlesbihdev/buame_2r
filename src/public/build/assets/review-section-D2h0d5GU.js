import{j as e,m as J,r as m}from"./app-CtDkYqvk.js";import{B as R}from"./button-DQldEkQg.js";import{c as K,a as b}from"./createLucideIcon-B0KkRYgx.js";import{S as C}from"./star-qAyBEM0r.js";import{I as $}from"./input-D3jpsBbb.js";import{L}from"./label-DVRfXvMc.js";import{T as U}from"./textarea-DmQpD8d2.js";import{C as Q}from"./camera-BA8w4JaG.js";import{X as z}from"./x-BXRLTyvb.js";import{L as ee}from"./loader-circle-Ddm8iWVa.js";import{M as P}from"./message-square-Cjw7BiPl.js";import{c as ae,a as te,u as G}from"./index-C5Wey4-O.js";import{P as E}from"./index-DIcHKZ6c.js";import{C as se}from"./chevron-down-5tyOsfMq.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ne=K("ZoomIn",re);function O({value:a=0,onChange:o,readonly:i=!1,size:l="md",showLabel:t=!1}){const n={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"},d=["","Poor","Fair","Good","Very Good","Excellent"];return e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(c=>e.jsx("button",{type:"button",onClick:()=>!i&&(o==null?void 0:o(c)),disabled:i,className:b("transition-transform",!i&&"cursor-pointer hover:scale-110",i&&"cursor-default"),children:e.jsx(C,{className:b(n[l],"transition-colors",c<=a?"fill-yellow-400 text-yellow-400":"text-gray-300 dark:text-gray-600")})},c)),t&&a>0&&e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-600 dark:text-gray-400",children:d[a]})]})}function oe({reviewableType:a,reviewableId:o,onSuccess:i,onCancel:l}){const{data:t,setData:n,post:d,processing:c,errors:r,reset:g}=J({reviewer_name:"",reviewer_phone:"",rating:0,comment:"",images:[]}),[w,j]=m.useState(0),[x,p]=m.useState([]),[F,N]=m.useState(!1),k=m.useRef(null),I=s=>{s.preventDefault(),d(route("reviews.store",{type:a,id:o}),{forceFormData:!0,preserveScroll:!0,preserveState:!0,onSuccess:()=>{g(),p([])}})},_=s=>{const h=Array.from(s.target.files||[]);A(h)},u=s=>{s.preventDefault(),N(!1);const h=Array.from(s.dataTransfer.files||[]);A(h)},f=s=>{s.preventDefault(),N(!0)},y=s=>{s.preventDefault(),N(!1)},A=s=>{const h=s.filter(v=>v.type.startsWith("image/")),D=3-t.images.length,S=h.slice(0,D);if(S.length>0){const v=[...t.images,...S];n("images",v),S.forEach(q=>{const M=new FileReader;M.onloadend=()=>{p(H=>[...H,M.result])},M.readAsDataURL(q)})}},Z=s=>{const h=t.images.filter((S,v)=>v!==s),D=x.filter((S,v)=>v!==s);n("images",h),p(D)};return e.jsx("div",{className:"border-t border-gray-200 p-6 dark:border-gray-800",children:e.jsxs("div",{className:"mx-auto max-w-2xl",children:[e.jsx("h3",{className:"mb-6 text-lg font-bold text-[var(--foreground)] dark:text-white",children:"Share Your Experience"}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(L,{htmlFor:"name",className:"mb-2 block text-sm font-medium",children:"Your Name *"}),e.jsx($,{id:"name",placeholder:"Enter your name",value:t.reviewer_name,onChange:s=>n("reviewer_name",s.target.value)}),r.reviewer_name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.reviewer_name})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"phone",className:"mb-2 block text-sm font-medium",children:"Phone Number *"}),e.jsx($,{id:"phone",placeholder:"+233 XX XXX XXXX",value:t.reviewer_phone,onChange:s=>n("reviewer_phone",s.target.value)}),r.reviewer_phone&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.reviewer_phone})]})]}),e.jsxs("div",{children:[e.jsx(L,{className:"mb-2 block text-sm font-medium",children:"Your Rating *"}),e.jsxs("div",{className:"flex items-center gap-1",onMouseLeave:()=>j(0),children:[[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>n("rating",s),onMouseEnter:()=>j(s),className:"p-1 transition-transform hover:scale-110",children:e.jsx(C,{className:b("h-8 w-8 transition-colors",(w||t.rating)>=s?"fill-yellow-400 text-yellow-400":"text-gray-300 dark:text-gray-600 hover:text-yellow-300")})},s)),t.rating>0&&e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-600 dark:text-gray-400",children:["","Poor","Fair","Good","Very Good","Excellent"][t.rating]})]}),r.rating&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.rating})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"comment",className:"mb-2 block text-sm font-medium",children:"Your Review *"}),e.jsx(U,{id:"comment",placeholder:"Share your experience with this product...",rows:4,value:t.comment,onChange:s=>n("comment",s.target.value),className:"resize-none"}),r.comment&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.comment})]}),e.jsxs("div",{children:[e.jsx(L,{className:"mb-2 block text-sm font-medium",children:"Add Photos (Optional)"}),e.jsxs("div",{onClick:()=>{var s;return(s=k.current)==null?void 0:s.click()},onDragOver:f,onDragLeave:y,onDrop:u,className:b("cursor-pointer rounded-xl border-2 border-dashed p-6 text-center transition-colors",F?"border-[var(--primary)] bg-[var(--primary)]/5":"border-gray-300 hover:border-[var(--primary)] dark:border-gray-700",t.images.length>=3&&"cursor-not-allowed opacity-50"),children:[e.jsx(Q,{className:"mx-auto h-10 w-10 text-gray-400"}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{className:"font-semibold text-[var(--primary)]",children:"Click to upload"})," ","or drag and drop"]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Max 3 images, 2MB each (JPEG, PNG, WebP)"}),e.jsx("input",{ref:k,type:"file",multiple:!0,accept:"image/jpeg,image/png,image/webp",className:"hidden",onChange:_,disabled:t.images.length>=3})]}),x.length>0&&e.jsx("div",{className:"mt-4 flex gap-3",children:x.map((s,h)=>e.jsxs("div",{className:"group relative",children:[e.jsx("img",{src:s,alt:`Preview ${h+1}`,className:"h-20 w-20 rounded-lg object-cover"}),e.jsx("button",{type:"button",onClick:()=>Z(h),className:"absolute -right-2 -top-2 rounded-full bg-red-500 p-1 text-white opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(z,{className:"h-3 w-3"})})]},h))}),r.images&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.images})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4",children:[e.jsx(R,{type:"button",variant:"ghost",onClick:l,children:"Cancel"}),e.jsx(R,{type:"submit",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Submit Review"]})})]})]})]})})}var X="Avatar",[le,Ie]=ae(X),[ie,T]=le(X),B=m.forwardRef((a,o)=>{const{__scopeAvatar:i,...l}=a,[t,n]=m.useState("idle");return e.jsx(ie,{scope:i,imageLoadingStatus:t,onImageLoadingStatusChange:n,children:e.jsx(E.span,{...l,ref:o})})});B.displayName=X;var Y="AvatarImage",ce=m.forwardRef((a,o)=>{const{__scopeAvatar:i,src:l,onLoadingStatusChange:t=()=>{},...n}=a,d=T(Y,i),c=de(l,n.referrerPolicy),r=te(g=>{t(g),d.onImageLoadingStatusChange(g)});return G(()=>{c!=="idle"&&r(c)},[c,r]),c==="loaded"?e.jsx(E.img,{...n,ref:o,src:l}):null});ce.displayName=Y;var W="AvatarFallback",V=m.forwardRef((a,o)=>{const{__scopeAvatar:i,delayMs:l,...t}=a,n=T(W,i),[d,c]=m.useState(l===void 0);return m.useEffect(()=>{if(l!==void 0){const r=window.setTimeout(()=>c(!0),l);return()=>window.clearTimeout(r)}},[l]),d&&n.imageLoadingStatus!=="loaded"?e.jsx(E.span,{...t,ref:o}):null});V.displayName=W;function de(a,o){const[i,l]=m.useState("idle");return G(()=>{if(!a){l("error");return}let t=!0;const n=new window.Image,d=c=>()=>{t&&l(c)};return l("loading"),n.onload=d("loaded"),n.onerror=d("error"),n.src=a,o&&(n.referrerPolicy=o),()=>{t=!1}},[a,o]),i}var me=B,xe=V;function ge({className:a,...o}){return e.jsx(me,{"data-slot":"avatar",className:b("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),...o})}function he({className:a,...o}){return e.jsx(xe,{"data-slot":"avatar-fallback",className:b("bg-muted flex size-full items-center justify-center rounded-full",a),...o})}function ue({review:a}){const[o,i]=m.useState(!1),[l,t]=m.useState(null),n=r=>{t(r),i(!0)},d=()=>{i(!1),t(null)},c=r=>{const g=new Date(r),j=new Date-g,x=Math.floor(j/(1e3*60*60*24));return x===0?"Today":x===1?"Yesterday":x<7?`${x}d ago`:x<30?`${Math.floor(x/7)}w ago`:x<365?`${Math.floor(x/30)}mo ago`:g.toLocaleDateString()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(ge,{className:"h-12 w-12 shrink-0",children:e.jsx(he,{className:"bg-[var(--primary)]/10 text-[var(--primary)] font-semibold",children:a.initials})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-[var(--foreground)] dark:text-white",children:a.reviewer_name}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"•"}),e.jsx(O,{value:a.rating,readonly:!0,size:"sm"}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"•"}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:c(a.created_at)})]}),a.comment&&e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed mb-3",children:a.comment}),a.images&&a.images.length>0&&e.jsx("div",{className:"flex gap-2",children:a.images.map((r,g)=>e.jsxs("button",{onClick:()=>n(r.url),className:"group relative h-20 w-20 overflow-hidden rounded-lg bg-gray-100 dark:bg-gray-800",children:[e.jsx("img",{src:r.url,alt:`Review image ${g+1}`,className:"h-full w-full object-cover transition-transform group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/0 transition-all group-hover:bg-black/30",children:e.jsx(ne,{className:"h-5 w-5 text-white opacity-0 transition-opacity group-hover:opacity-100"})})]},g))})]})]})}),o&&l&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/95 p-4",onClick:d,children:[e.jsx("button",{onClick:d,className:"absolute right-4 top-4 z-10 rounded-full bg-white/10 p-2 text-white backdrop-blur-sm transition-colors hover:bg-white/20",children:e.jsx(z,{className:"h-6 w-6"})}),e.jsx("div",{className:"relative max-h-[85vh] max-w-5xl",children:e.jsx("img",{src:l,alt:"Review image",className:"max-h-[85vh] w-full rounded-lg object-contain",onClick:r=>r.stopPropagation()})})]})]})}function pe({reviews:a,onLoadMore:o,hasMore:i,loading:l,onOpenForm:t}){return!a||a.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800",children:e.jsx(P,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"mb-2 font-semibold text-[var(--foreground)] dark:text-white",children:"No Reviews Yet"}),e.jsx("p",{className:"mb-6 text-sm text-gray-500 dark:text-gray-400",children:"Be the first to share your experience!"}),e.jsxs(R,{onClick:t,children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Write the First Review"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-800",children:a.map(n=>e.jsx(ue,{review:n},n.id))}),i&&e.jsx("div",{className:"border-t border-gray-200 p-4 text-center dark:border-gray-800",children:e.jsx(R,{variant:"ghost",onClick:o,disabled:l,children:l?"Loading...":e.jsxs(e.Fragment,{children:["Load More Reviews",e.jsx(se,{className:"ml-2 h-4 w-4"})]})})})]})}function _e({reviewableType:a,reviewableId:o,reviews:i=[],averageRating:l=0,reviewsCount:t=0,ratingBreakdown:n={5:0,4:0,3:0,2:0,1:0}}){const[d,c]=m.useState(!1),[r,g]=m.useState(i.slice(0,10)),[w,j]=m.useState(1),x=10,p=r.length<i.length,F=()=>{const u=w+1,f=w*x,y=f+x,A=i.slice(f,y);g([...r,...A]),j(u)},N=()=>{c(!1),window.location.reload()},k=()=>{c(!0)},I=()=>{c(!1)},_=u=>t===0?0:Math.round(u/t*100);return e.jsxs("div",{className:"mt-8 rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-[var(--card)]",children:[e.jsx("div",{className:"border-b border-gray-200 bg-gradient-to-r from-[var(--primary)]/5 to-transparent p-6 dark:border-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-[var(--foreground)] dark:text-white",children:"Customer Reviews"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"See what others are saying"})]}),!d&&e.jsxs(R,{onClick:k,children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Write a Review"]})]})}),t>0&&e.jsxs("div",{className:"grid gap-6 p-6 md:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center rounded-xl bg-gray-50 p-6 dark:bg-gray-800/50",children:[e.jsx("div",{className:"text-5xl font-black text-[var(--foreground)] dark:text-white",children:l.toFixed(1)}),e.jsx("div",{className:"mt-2 flex items-center gap-1",children:e.jsx(O,{value:Math.round(l),readonly:!0,size:"md"})}),e.jsxs("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:["Based on ",t," ",t===1?"review":"reviews"]})]}),e.jsx("div",{className:"space-y-3",children:[5,4,3,2,1].map(u=>{const f=n[u]||0,y=_(f);return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-3 text-sm font-semibold text-gray-600 dark:text-gray-400",children:u}),e.jsx(C,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("div",{className:"h-2.5 flex-1 overflow-hidden rounded-full bg-gray-200 dark:bg-gray-700",children:e.jsx("div",{className:"h-full rounded-full bg-yellow-400 transition-all",style:{width:`${y}%`}})}),e.jsxs("span",{className:"w-12 text-right text-sm text-gray-500 dark:text-gray-400",children:[y,"%"]}),e.jsxs("span",{className:"w-8 text-right text-sm text-gray-500 dark:text-gray-400",children:["(",f,")"]})]},u)})})]}),d&&e.jsx(oe,{reviewableType:a,reviewableId:o,onSuccess:N,onCancel:I},`review-form-${a}-${o}`),e.jsx(pe,{reviews:r,onLoadMore:F,hasMore:p,loading:!1,onOpenForm:k})]})}export{_e as R,ne as Z};
