import{j as e,L,$ as B,S as $}from"./app-Dxpbdbp-.js";import{S as a}from"./StatsCard-DNZsLS7d.js";import{B as O}from"./button-Ddh2pgYs.js";import{C as n,a as d,b as o,c,d as m}from"./card-DFlHDBpM.js";import{S as k,a as T,b as D,c as E,d as x}from"./select-wf2yveV_.js";import{A as M}from"./admin-layout-D_Oco4wL.js";import{A as z}from"./arrow-left-1dvwvpAM.js";import{C as R}from"./calendar-CPLYyzlh.js";import{C as V}from"./circle-check-big-D1A8xB7r.js";import{T as G}from"./trending-up-ZYTslHvK.js";import{T as H}from"./x-B0uux2HT.js";import{C as I}from"./toast-provider-DUdhWUAF.js";import{C as P}from"./clock-BDjkUgmZ.js";import"./createLucideIcon-zv5RrChz.js";import"./index-Kgqb1zqS.js";import"./index-DmPNOzho.js";import"./index-B_H47deK.js";import"./Combination-m3aLTxiZ.js";import"./index-D974EI9O.js";import"./index-trczTq3b.js";import"./index-B3rIy2zH.js";import"./chevron-down-dZktRGef.js";import"./check-CgK6jj3H.js";import"./chevron-up-Dr9AnH_t.js";import"./app-logo-C3sRPIHp.js";import"./log-out-CHM0YE-w.js";import"./users-Bk6ZWDE7.js";import"./package-Dx1Z4zVP.js";import"./star-DqQwbCgH.js";import"./credit-card-CXrIW_8s.js";import"./shield-T9KGnMUc.js";import"./message-square-Cn8WjWqz.js";import"./menu-BUhNRGva.js";function Ne({analytics:r,dateRange:p}){var h,u,j,g,b,f,v;const N=s=>{$.get(route("admin.subscriptions.analytics"),{range:s},{preserveState:!0})},C={artisans:"bg-blue-500",hotels:"bg-purple-500",transport:"bg-green-500",rentals:"bg-yellow-500",marketplace:"bg-pink-500",jobs:"bg-orange-500"},S={Active:"bg-green-500","Grace Period":"bg-yellow-500",Expired:"bg-red-500",Cancelled:"bg-gray-500"},i=Object.values(r.byCategory||{}).reduce((s,t)=>s+t,0),l=Object.values(r.byStatus||{}).reduce((s,t)=>s+t,0);return e.jsxs(M,{children:[e.jsx(L,{title:"Subscription Analytics"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(B,{href:route("admin.subscriptions.index"),children:e.jsxs(O,{variant:"ghost",size:"sm",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Back"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-foreground text-2xl font-bold",children:"Subscription Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"Overview of subscription metrics"})]})]}),e.jsxs(k,{value:String(p),onValueChange:N,children:[e.jsxs(T,{className:"w-[180px]",children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),e.jsx(D,{})]}),e.jsxs(E,{children:[e.jsx(x,{value:"7",children:"Last 7 days"}),e.jsx(x,{value:"30",children:"Last 30 days"}),e.jsx(x,{value:"90",children:"Last 90 days"}),e.jsx(x,{value:"365",children:"Last year"})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(a,{title:"Total Active",value:((h=r.totalActive)==null?void 0:h.toLocaleString())||0,description:"Active subscriptions",icon:V}),e.jsx(a,{title:"New Subscriptions",value:((u=r.newSubscriptions)==null?void 0:u.toLocaleString())||0,description:`Last ${p} days`,icon:G}),e.jsx(a,{title:"Expiring Soon",value:((j=r.expiringSoon)==null?void 0:j.toLocaleString())||0,description:"Within 7 days",icon:H}),e.jsx(a,{title:"Recently Expired",value:((g=r.recentlyExpired)==null?void 0:g.toLocaleString())||0,description:"Last 30 days",icon:I})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Active by Category"}),e.jsx(c,{children:"Distribution of active subscriptions"})]}),e.jsx(m,{children:Object.keys(r.byCategory||{}).length>0?e.jsx("div",{className:"space-y-4",children:Object.entries(r.byCategory).map(([s,t])=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-foreground text-sm font-medium capitalize",children:s}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:[t," (",i>0?Math.round(t/i*100):0,"%)"]})]}),e.jsx("div",{className:"bg-muted h-2 overflow-hidden rounded-full",children:e.jsx("div",{className:`h-full rounded-full ${C[s]||"bg-primary"}`,style:{width:`${i>0?t/i*100:0}%`}})})]},s))}):e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:"No data available"})})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"By Status"}),e.jsx(c,{children:"All subscriptions by status"})]}),e.jsx(m,{children:Object.keys(r.byStatus||{}).length>0?e.jsx("div",{className:"space-y-4",children:Object.entries(r.byStatus).map(([s,t])=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-foreground text-sm font-medium",children:s}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:[t," (",l>0?Math.round(t/l*100):0,"%)"]})]}),e.jsx("div",{className:"bg-muted h-2 overflow-hidden rounded-full",children:e.jsx("div",{className:`h-full rounded-full ${S[s]||"bg-primary"}`,style:{width:`${l>0?t/l*100:0}%`}})})]},s))}):e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:"No data available"})})]})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Billing Cycle Distribution"}),e.jsx(c,{children:"Active subscriptions by billing cycle"})]}),e.jsx(m,{children:Object.keys(r.byBillingCycle||{}).length>0?e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:Object.entries(r.byBillingCycle).map(([s,t])=>e.jsxs("div",{className:"border-border rounded-lg border p-4 text-center",children:[e.jsx("div",{className:"bg-primary/10 text-primary mx-auto mb-2 flex h-12 w-12 items-center justify-center rounded-full",children:e.jsx(P,{className:"h-6 w-6"})}),e.jsx("p",{className:"text-foreground text-2xl font-bold",children:t}),e.jsx("p",{className:"text-muted-foreground text-sm",children:s})]},s))}):e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:"No data available"})})]}),((b=r.trend)==null?void 0:b.length)>0&&e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"New Subscriptions Trend"}),e.jsx(c,{children:"Daily new subscriptions over the selected period"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"flex h-[200px] items-end gap-1",children:r.trend.map((s,t)=>{const y=Math.max(...r.trend.map(A=>A.count)),w=y>0?s.count/y*100:0;return e.jsx("div",{className:"group relative flex-1",title:`${s.date}: ${s.count} subscriptions`,children:e.jsx("div",{className:"bg-primary/20 hover:bg-primary/40 absolute bottom-0 w-full rounded-t transition-colors",style:{height:`${Math.max(w,4)}%`}})},t)})}),e.jsxs("div",{className:"text-muted-foreground mt-2 flex justify-between text-xs",children:[e.jsx("span",{children:(f=r.trend[0])==null?void 0:f.date}),e.jsx("span",{children:(v=r.trend[r.trend.length-1])==null?void 0:v.date})]})]})]})]})]})}export{Ne as default};
