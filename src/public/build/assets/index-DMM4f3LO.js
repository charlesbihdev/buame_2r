import{j as e,r as x,$,L as U,S}from"./app-Dxpbdbp-.js";import{B as v}from"./button-Ddh2pgYs.js";import{C as L}from"./check-CgK6jj3H.js";import{X as I}from"./x-B0uux2HT.js";import{T as M}from"./trash-2-DTFbRV_7.js";import{C as q}from"./ConfirmDialog-Cg4UXuTp.js";import{F as G}from"./FilterBar-CHnpTB5V.js";import{D as X,a as K,b as Q,c as W}from"./dialog-CGfVtw_G.js";import{C}from"./chevron-left-um5H2WIP.js";import{C as _}from"./chevron-right-BtAw8our.js";import{C as z}from"./checkbox-BWi7p-ei.js";import{S as Y}from"./StatusBadge-Ck7l5q7t.js";import{a as w}from"./createLucideIcon-zv5RrChz.js";import{A as Z}from"./admin-layout-D_Oco4wL.js";import{M as ee}from"./message-square-Cn8WjWqz.js";import{S as te}from"./star-DqQwbCgH.js";import{I as se}from"./image-BUqnJy6I.js";import"./input-WeaLLMUP.js";import"./select-wf2yveV_.js";import"./index-Kgqb1zqS.js";import"./index-DmPNOzho.js";import"./index-B_H47deK.js";import"./Combination-m3aLTxiZ.js";import"./index-D974EI9O.js";import"./index-trczTq3b.js";import"./index-B3rIy2zH.js";import"./chevron-down-dZktRGef.js";import"./chevron-up-Dr9AnH_t.js";import"./search-DvN8X0mW.js";import"./index-DWxDVpG3.js";import"./index-_E8f7xb7.js";import"./app-logo-C3sRPIHp.js";import"./toast-provider-DUdhWUAF.js";import"./log-out-CHM0YE-w.js";import"./users-Bk6ZWDE7.js";import"./package-Dx1Z4zVP.js";import"./credit-card-CXrIW_8s.js";import"./shield-T9KGnMUc.js";import"./menu-BUhNRGva.js";function re({selectedCount:n,onApprove:r,onDisapprove:s,onDelete:m,onClear:o,showDelete:i=!1,processing:d=!1}){return n===0?null:e.jsxs("div",{className:"bg-primary/5 border-primary/20 flex items-center justify-between rounded-lg border px-4 py-3",children:[e.jsxs("span",{className:"text-foreground text-sm font-medium",children:[n," review",n>1?"s":""," selected"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsxs(v,{variant:"outline",size:"sm",onClick:r,disabled:d,className:"gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Approve"]}),s&&e.jsxs(v,{variant:"outline",size:"sm",onClick:s,disabled:d,className:"gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Disapprove"]}),i&&m&&e.jsxs(v,{variant:"destructive",size:"sm",onClick:m,disabled:d,className:"gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),"Delete"]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:o,disabled:d,children:"Clear Selection"})]})]})}function ae({open:n,onOpenChange:r,images:s=[],title:m="Review Images"}){var u;const[o,i]=x.useState(0);x.useEffect(()=>{n&&i(0)},[n,s]);const d=()=>{i(h=>h===0?s.length-1:h-1)},c=()=>{i(h=>h===s.length-1?0:h+1)};return s.length?e.jsx(X,{open:n,onOpenChange:r,children:e.jsxs(K,{className:"max-w-3xl",children:[e.jsx(Q,{children:e.jsx(W,{children:m})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"relative aspect-video overflow-hidden rounded-lg bg-black",children:e.jsx("img",{src:`/storage/${(u=s[o])==null?void 0:u.image_path}`,alt:`Image ${o+1}`,className:"h-full w-full object-contain"})}),s.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(v,{variant:"secondary",size:"icon",className:"absolute left-2 top-1/2 -translate-y-1/2",onClick:d,children:e.jsx(C,{className:"h-4 w-4"})}),e.jsx(v,{variant:"secondary",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2",onClick:c,children:e.jsx(_,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 rounded-full bg-black/50 px-3 py-1 text-sm text-white",children:[o+1," / ",s.length]})]}),s.length>1&&e.jsx("div",{className:"mt-4 flex gap-2 overflow-x-auto pb-2",children:s.map((h,b)=>e.jsx("button",{onClick:()=>i(b),className:`h-16 w-16 shrink-0 overflow-hidden rounded-md border-2 transition-colors ${b===o?"border-primary":"border-transparent"}`,children:e.jsx("img",{src:`/storage/${h.image_path}`,alt:`Thumbnail ${b+1}`,className:"h-full w-full object-cover"})},h.id||b))})]})}):null}function le({columns:n,data:r,pagination:s,emptyMessage:m="No data found",emptyIcon:o,selectedIds:i,onSelectionChange:d}){const c=r.length>0&&r.every(a=>i.includes(a.id)),u=r.some(a=>i.includes(a.id)),h=a=>{if(a){const g=[...new Set([...i,...r.map(p=>p.id)])];d(g)}else{const g=r.map(p=>p.id);d(i.filter(p=>!g.includes(p)))}},b=(a,g)=>{d(g?[...i,a]:i.filter(p=>p!==a))};return e.jsxs("div",{className:"border-border rounded-lg border",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 px-4 py-3",children:e.jsx(z,{checked:c,"data-state":u&&!c?"indeterminate":void 0,onCheckedChange:h})}),n.map(a=>e.jsx("th",{className:"text-muted-foreground px-4 py-3 text-left text-sm font-medium",children:a.label},a.key))]})}),e.jsx("tbody",{children:r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:n.length+1,className:"text-muted-foreground px-4 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[o&&e.jsx(o,{className:"h-10 w-10 opacity-50"}),e.jsx("p",{children:m})]})})}):r.map((a,g)=>e.jsxs("tr",{className:"border-border hover:bg-muted/30 border-t transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(z,{checked:i.includes(a.id),onCheckedChange:p=>b(a.id,p)})}),n.map(p=>e.jsx("td",{className:"px-4 py-3 text-sm",children:p.render?p.render(a):a[p.key]},p.key))]},a.id||g))})]})}),s&&s.last_page>1&&e.jsxs("div",{className:"border-border flex items-center justify-between border-t px-4 py-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:["Showing ",s.from," to ",s.to," of ",s.total]}),e.jsxs("div",{className:"flex gap-2",children:[s.prev_page_url?e.jsx($,{href:s.prev_page_url,preserveScroll:!0,preserveState:!0,children:e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(C,{className:"h-4 w-4"}),"Previous"]})}):e.jsxs(v,{variant:"outline",size:"sm",disabled:!0,children:[e.jsx(C,{className:"h-4 w-4"}),"Previous"]}),s.next_page_url?e.jsx($,{href:s.next_page_url,preserveScroll:!0,preserveState:!0,children:e.jsxs(v,{variant:"outline",size:"sm",children:["Next",e.jsx(_,{className:"h-4 w-4"})]})}):e.jsxs(v,{variant:"outline",size:"sm",disabled:!0,children:["Next",e.jsx(_,{className:"h-4 w-4"})]})]})]})]})}const B=x.forwardRef(({className:n,value:r,onValueChange:s,...m},o)=>{const[i,d]=x.useState(r||"");x.useEffect(()=>{r!==void 0&&d(r)},[r]);const c=u=>{d(u),s&&s(u)};return e.jsx("div",{ref:o,className:w("w-full",n),...m,children:x.Children.map(m.children,u=>x.isValidElement(u)?x.cloneElement(u,{value:i,onValueChange:c}):u)})});B.displayName="Tabs";const F=x.forwardRef(({className:n,...r},s)=>e.jsx("div",{ref:s,className:w("inline-flex h-10 items-center justify-center rounded-lg bg-[#f6f8f6]#1a331a] p-1 text-gray-600",n),...r}));F.displayName="TabsList";const y=x.forwardRef(({className:n,value:r,onValueChange:s,activeValue:m,children:o,...i},d)=>{const c=m===r;return e.jsx("button",{ref:d,type:"button",className:w("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--primary)] disabled:pointer-events-none disabled:opacity-50",c?"bg-white text-[var(--foreground)] shadow-sm":"text-gray-600 hover:text-[var(--foreground)]",n),onClick:()=>s==null?void 0:s(r),...i,children:o})});y.displayName="TabsTrigger";const ne=x.forwardRef(({className:n,value:r,activeValue:s,...m},o)=>s!==r?null:e.jsx("div",{ref:o,className:w("mt-2 focus-visible:outline-none",n),...m}));ne.displayName="TabsContent";function qe({reviews:n,filters:r,counts:s}){const[m,o]=x.useState([]),[i,d]=x.useState(!1),[c,u]=x.useState({open:!1,action:null,review:null}),[h,b]=x.useState({open:!1,images:[]}),a=r.status||"all",g=t=>{S.get(route("admin.reviews.index"),{...r,status:t==="all"?void 0:t},{preserveState:!0,preserveScroll:!0}),o([])},p=(t,l)=>{u({open:!0,action:l,review:t})},k=t=>{u({open:!0,action:t,review:null})},P=()=>{d(!0);const t=!c.review;let l,f={};if(t){switch(c.action){case"approve":l="admin.reviews.bulk-approve";break;case"disapprove":l="admin.reviews.bulk-disapprove";break;case"delete":l="admin.reviews.bulk-delete";break}f={ids:m},S.post(route(l),f,{preserveScroll:!0,onFinish:()=>{d(!1),u({open:!1,action:null,review:null}),o([])}})}else{switch(c.action){case"approve":l="admin.reviews.approve";break;case"disapprove":l="admin.reviews.disapprove";break;case"delete":l="admin.reviews.destroy";break}const j=c.action==="delete"?"delete":"post";S[j](route(l,c.review.id),f,{preserveScroll:!0,onFinish:()=>{d(!1),u({open:!1,action:null,review:null})}})}},E=()=>{var f,j;const t=!c.review,l=t?m.length:1;switch(c.action){case"approve":return{title:`Approve ${l} Review${l>1?"s":""}`,description:t?`Are you sure you want to approve ${l} selected reviews? They will be visible to users.`:`Are you sure you want to approve this review from "${(f=c.review)==null?void 0:f.reviewer_name}"?`,confirmLabel:"Approve",variant:"default"};case"disapprove":return{title:`Disapprove ${l} Review${l>1?"s":""}`,description:t?`Are you sure you want to disapprove ${l} selected reviews? They will be hidden from users.`:`Are you sure you want to disapprove this review from "${(j=c.review)==null?void 0:j.reviewer_name}"?`,confirmLabel:"Disapprove",variant:"destructive"};case"delete":return{title:`Delete ${l} Review${l>1?"s":""}`,description:t?`Are you sure you want to permanently delete ${l} selected reviews? This action cannot be undone.`:"Are you sure you want to permanently delete this review? This action cannot be undone.",confirmLabel:"Delete",variant:"destructive"};default:return{}}},V=t=>{var l,f,j,T,A,R,D;return((l=t.artisan)==null?void 0:l.name)||((f=t.hotel)==null?void 0:f.name)||((j=t.transport_ride)==null?void 0:j.vehicle_name)||((T=t.marketplace_product)==null?void 0:T.title)||((A=t.rental)==null?void 0:A.name)||((R=t.job)==null?void 0:R.title)||((D=t.store)==null?void 0:D.name)||"Unknown"},H=t=>t.artisan_id?"Artisan":t.hotel_id?"Hotel":t.transport_ride_id?"Transport":t.marketplace_product_id?"Product":t.rental_id?"Rental":t.job_id?"Job":t.store_id?"Store":"Unknown",O=[{key:"reviewer",label:"Reviewer",render:t=>e.jsxs("div",{children:[e.jsx("p",{className:"text-foreground font-medium",children:t.reviewer_name}),e.jsx("p",{className:"text-muted-foreground text-xs",children:t.reviewer_phone})]})},{key:"rating",label:"Rating",render:t=>e.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((l,f)=>e.jsx(te,{className:`h-4 w-4 ${f<t.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},f))})},{key:"comment",label:"Comment",render:t=>e.jsx("p",{className:"text-foreground max-w-[300px] truncate text-sm",children:t.comment||e.jsx("span",{className:"text-muted-foreground italic",children:"No comment"})})},{key:"reviewable",label:"For",render:t=>e.jsxs("div",{children:[e.jsx("p",{className:"text-foreground text-sm",children:V(t)}),e.jsx("p",{className:"text-muted-foreground text-xs",children:H(t)})]})},{key:"images",label:"Images",render:t=>{var l;return((l=t.images)==null?void 0:l.length)>0?e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>b({open:!0,images:t.images}),className:"gap-1",children:[e.jsx(se,{className:"h-4 w-4"}),t.images.length]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"-"})}},{key:"status",label:"Status",render:t=>e.jsx(Y,{status:t.status,type:"review"})},{key:"created_at",label:"Date",render:t=>e.jsx("span",{className:"text-muted-foreground text-sm",children:new Date(t.created_at).toLocaleDateString()})},{key:"actions",label:"Actions",render:t=>e.jsxs("div",{className:"flex items-center gap-1",children:[t.status!=="approved"&&e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>p(t,"approve"),children:e.jsx(L,{className:"h-4 w-4 text-green-500"})}),t.status!=="disapproved"&&e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>p(t,"disapprove"),children:e.jsx(I,{className:"h-4 w-4 text-orange-500"})}),t.status==="disapproved"&&e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>p(t,"delete"),children:e.jsx(M,{className:"text-destructive h-4 w-4"})})]})}],J=[{key:"rating",label:"Rating",placeholder:"Filter by rating",options:[{value:"5",label:"5 Stars"},{value:"4",label:"4 Stars"},{value:"3",label:"3 Stars"},{value:"2",label:"2 Stars"},{value:"1",label:"1 Star"}]},{key:"type",label:"Type",placeholder:"Filter by type",options:[{value:"artisan",label:"Artisan"},{value:"hotel",label:"Hotel"},{value:"transport",label:"Transport"},{value:"marketplace",label:"Marketplace"},{value:"rental",label:"Rental"},{value:"job",label:"Job"},{value:"store",label:"Store"}]}],N=E();return e.jsxs(Z,{children:[e.jsx(U,{title:"Review Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-foreground text-2xl font-bold",children:"Review Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Moderate and manage user reviews"})]}),e.jsx(B,{value:a,onValueChange:g,children:e.jsxs(F,{children:[e.jsxs(y,{value:"all",activeValue:a,children:["All (",s.all,")"]}),e.jsxs(y,{value:"pending",activeValue:a,children:["Pending (",s.pending,")"]}),e.jsxs(y,{value:"approved",activeValue:a,children:["Approved (",s.approved,")"]}),e.jsxs(y,{value:"disapproved",activeValue:a,children:["Disapproved (",s.disapproved,")"]})]})}),e.jsx(G,{filters:J,searchPlaceholder:"Search by name, phone, or comment...",currentFilters:r}),e.jsx(re,{selectedCount:m.length,onApprove:a!=="approved"?()=>k("approve"):null,onDisapprove:a!=="disapproved"?()=>k("disapprove"):null,onDelete:a==="disapproved"?()=>k("delete"):null,showDelete:a==="disapproved",onClear:()=>o([]),processing:i}),e.jsx(le,{columns:O,data:n.data,pagination:n,emptyMessage:"No reviews found",emptyIcon:ee,selectedIds:m,onSelectionChange:o})]}),e.jsx(q,{open:c.open,onOpenChange:t=>u({...c,open:t}),title:N.title,description:N.description,confirmLabel:N.confirmLabel,variant:N.variant,onConfirm:P,loading:i}),e.jsx(ae,{open:h.open,onOpenChange:t=>b({...h,open:t}),images:h.images,title:"Review Images"})]})}export{qe as default};
